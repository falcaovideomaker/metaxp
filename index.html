<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" content="#6b4f2c">
  <link rel="manifest" href="manifest.json?v=2.3.1">
  <title>Meta XP ‚Äî 2.3.1 (RPG)</title>
  <style>
    :root{
      --bg:#17130e; --bg2:#1e1912; --ink:#e8d9b8; --muted:#cbbf9b;
      --accent:#d4a05a; --accent2:#8fb873;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; font-family: ui-serif, Georgia, 'Times New Roman', serif; color:var(--ink);
      background:
        radial-gradient(1200px 800px at 15% -10%, #31251566, transparent),
        radial-gradient(1200px 800px at 115% 110%, #2a201466, transparent),
        linear-gradient(180deg, var(--bg), var(--bg2));
    }
    .row{display:flex; gap:10px; flex-wrap:wrap;}
    .card{background:linear-gradient(180deg, #1e1912, #17130e); border:1px solid #2a2217; border-radius:14px; padding:14px; margin-bottom:12px; box-shadow: 0 10px 30px #0008;}
    header{ position:sticky; top:0; z-index:5; padding:12px 14px; border-bottom:1px solid #2a2217; backdrop-filter: blur(6px) saturate(120%); background:#110d09cc; }
    .chip{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; background:#14100b; border:1px solid #2a2217; font-size:12px;}
    .xpbar{display:flex; align-items:center; gap:10px;}
    .xpbar .bar{flex:1; height:12px; background:#0e0b08; border:1px solid #2a2217; border-radius:999px; overflow:hidden;}
    .xpbar .fill{height:100%; width:0%; background:linear-gradient(90deg, #d4a05a, #8fb873);}
    .tabs{display:flex; gap:8px; padding:8px; position:sticky; top:84px; background:#0f0c09ee; border-bottom:1px solid #2a2217; z-index:4;}
    .tab{flex:1; text-align:center; padding:10px 12px; border:1px solid #2a2217; border-radius:999px; background:#14100b; cursor:pointer;}
    .tab.active{outline:2px solid #8a6a3faa;}
    .goal{display:flex; gap:12px; align-items:center; justify-content:space-between; padding:12px; border:1px solid #2a2217; border-radius:12px; background:#14100b;}
    .attrTag{padding:4px 8px; border-radius:8px; border:1px solid #2a2217; background:#14100b; font-size:12px;}
    .addfab{position:fixed; right:18px; bottom:18px; border-radius:999px; padding:14px 18px; font-size:18px; z-index:6; background:linear-gradient(90deg, #6b4f2c, #8a6a3f); color:#f5e8c8; border:1px solid #2a2217;}
    .empty{opacity:.8; text-align:center; padding:24px;}
    main{max-width:920px; margin:0 auto; padding:12px 14px 90px;}
    button,input,select{border-radius:10px; border:1px solid #2a2217; background:#14100b; color:var(--ink); padding:10px; font-size:16px;}
  </style>
</head>
<body>
  <header>
    <div class="row" style="align-items:center;">
      <div style="flex:1;">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
          <div style="font-weight:900; letter-spacing:.5px;" id="charNameView">Aventureiro</div>
          <span class="chip">Nv. <span id="charLevel">1</span></span>
        </div>
        <div class="xpbar" style="margin-top:6px;">
          <div class="bar"><div class="fill" id="charXPFill"></div></div>
          <div class="chip"><span id="charXP">0</span>/<span id="charNext">100</span></div>
        </div>
      </div>
      <span class="chip">ü™ô Ouro: <b id="goldBalance">0</b></span>
      <button id="editCharBtn" class="chip">‚öôÔ∏è Editar</button>
    </div>
  </header>

  <div class="tabs">
    <div class="tab active" data-tab="missoes">üó°Ô∏è Miss√µes</div>
    <div class="tab" data-tab="atributos">üõ°Ô∏è Atributos</div>
    <div class="tab" data-tab="calendario">üìú Calend√°rio</div>
    <div class="tab" data-tab="rewards">üí∞ Recompensas</div>
    <div class="tab" data-tab="config">‚öôÔ∏è Configura√ß√µes</div>
  </div>

  <main>
    <!-- Miss√µes -->
    <section id="tab-missoes">
      <div class="card">
        <div class="row">
          <select id="range"><option value="day">Hoje</option><option value="week">Semana</option><option value="month">M√™s</option></select>
          <input type="date" id="baseDate">
          <button id="newMission" class="addfab">Ôºã Miss√£o</button>
        </div>
      </div>
      <div id="missionList"></div>
      <div class="empty" id="missionEmpty">Nenhuma miss√£o. Toque em ‚ÄúÔºã Miss√£o‚Äù.</div>
    </section>

    <!-- Atributos -->
    <section id="tab-atributos" style="display:none;">
      <div class="card">
        <div class="row" style="align-items:flex-end;">
          <input id="newAttrName" placeholder="Novo atributo (ex.: For√ßa, Disciplina)" style="flex:2">
          <button id="addAttr" style="flex:1">Criar atributo</button>
        </div>
        <p class="muted">Cada atributo tem n√≠vel e XP pr√≥prios. Conclua miss√µes vinculadas pra evolu√≠-los.</p>
      </div>
      <div id="attrList"></div>
      <div class="empty" id="attrEmpty">Sem atributos ainda. Crie o primeiro acima üëÜ</div>
    </section>

    <!-- Calend√°rio -->
    <section id="tab-calendario" style="display:none;">
      <div class="card">
        <div class="row" style="align-items:center;">
          <button id="prevMonth">‚óÄ</button>
          <div style="flex:1; text-align:center; font-weight:900;" id="calMonthTitle">M√™s</div>
          <button id="nextMonth">‚ñ∂</button>
        </div>
        <div class="row" style="gap:6px; margin-top:8px;">
          <span class="chip" style="flex:1; text-align:center;">Dom</span>
          <span class="chip" style="flex:1; text-align:center;">Seg</span>
          <span class="chip" style="flex:1; text-align:center;">Ter</span>
          <span class="chip" style="flex:1; text-align:center;">Qua</span>
          <span class="chip" style="flex:1; text-align:center;">Qui</span>
          <span class="chip" style="flex:1; text-align:center;">Sex</span>
          <span class="chip" style="flex:1; text-align:center;">S√°b</span>
        </div>
        <div class="calendar" id="calendarGrid" style="display:grid; grid-template-columns: repeat(7,1fr); gap:8px; margin-top:10px;"></div>
      </div>
    </section>

    <!-- Recompensas -->
    <section id="tab-rewards" style="display:none;">
      <div class="card">
        <div class="row" style="align-items:flex-end;">
          <input id="rewardName" placeholder="Nome da recompensa (ex.: üçï Pizza com amigos)" style="flex:2">
          <input id="rewardCost" type="number" min="1" value="50" style="width:140px" placeholder="Custo (ouro)">
          <button id="addReward" style="flex:1">Adicionar</button>
        </div>
      </div>
      <div id="rewardList"></div>
      <div class="empty" id="rewardEmpty">Sem recompensas ainda. Crie a primeira acima üëÜ</div>

      <div class="card" style="margin-top:12px;">
        <h3 style="margin:0 0 8px 0;">Hist√≥rico</h3>
        <div id="rewardHistory"></div>
        <div class="muted small" id="rewardHistoryEmpty">Hist√≥rico vazio.</div>
      </div>
    </section>

    <!-- Config -->
    <section id="tab-config" style="display:none;">
      <div class="card">
        <h3 style="margin:0 0 8px 0;">Dados</h3>
        <div class="row">
          <button id="exportBtn">Exportar JSON</button>
          <label class="chip" style="cursor:pointer;">Importar JSON <input id="importFile" type="file" accept="application/json" style="display:none"></label>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal Miss√£o -->
  <div class="modal" id="missionModal" style="position:fixed; inset:0; display:none; align-items:flex-end; justify-content:center; background:#0009;">
    <div class="sheet" style="background:#1a140d; border-top-left-radius:18px; border-top-right-radius:18px; width:100%; max-width:920px; padding:16px; border:1px solid #2a2217; max-height:85vh; overflow:auto;">
      <h3 style="margin:0 0 10px 0;">Nova miss√£o</h3>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
        <div><label class="small muted">T√≠tulo</label><input id="mTitle" placeholder="Ex.: Treinar 30 min"></div>
        <div><label class="small muted">Recorr√™ncia</label><select id="mRecur"><option value="once">√önica</option><option value="weekly">Semanal</option></select></div>
        <div><label class="small muted">Data</label><input type="date" id="mDate"></div>
        <div><label class="small muted">Hor√°rio</label><input type="time" id="mTime" value="07:00"></div>
        <div>
          <label class="small muted">Repetir (semana)</label>
          <div class="row" id="mWeekdays">
            <label class="attrTag"><input type="checkbox" value="1"> Seg</label>
            <label class="attrTag"><input type="checkbox" value="2"> Ter</label>
            <label class="attrTag"><input type="checkbox" value="3"> Qua</label>
            <label class="attrTag"><input type="checkbox" value="4"> Qui</label>
            <label class="attrTag"><input type="checkbox" value="5"> Sex</label>
            <label class="attrTag"><input type="checkbox" value="6"> S√°b</label>
            <label class="attrTag"><input type="checkbox" value="0"> Dom</label>
          </div>
        </div>
        <div><label class="small muted">Dificuldade</label>
          <select id="mDiff">
            <option value="easy">F√°cil (x1)</option>
            <option value="medium">M√©dia (x1.5)</option>
            <option value="hard">Dif√≠cil (x2)</option>
          </select>
        </div>
        <div><label class="small muted">XP do personagem</label><input type="number" id="mXP" min="0" value="10"></div>
        <div><label class="small muted">Atributos (XP por atributo)</label><div id="mAttrList"></div><button id="addAttrAlloc" class="chip" style="margin-top:8px;">+ Atribui√ß√£o</button></div>
      </div>
      <div class="row" style="margin-top:10px; justify-content:flex-end;"><button id="createMission">Criar miss√£o</button></div>
    </div>
  </div>

  <script src="app.js?v=2.3.1"></script>
  <script>if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js');}</script>
</body>
</html>
